---
title: "initial scrape of governments"
author: "Stefan Haußner"
date: "12 Mai 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(rvest)
library(janitor)
```


This script scrapes all government members from official or nonofficial webpages. The final lists should contain Name, Portfolio and the party s*he is affiliated to.

# Austria

Source with party affiliations: https://en.wikipedia.org/wiki/Second_Kurz_government
Official source: https://www.bundeskanzleramt.gv.at/bundeskanzleramt/die-bundesregierung/bundesministerinnen-und-bundesminister.html


Offene Fragen: Welchen Status haben State Secretaries in Österreich? Sie sind einem Ministerium zugeordnet, werden aber scheinbar von den Parteien nominiert. Es gibt außerdem nur wenige. Sind die "unabhängig" vom Ministerium oder ähnlich wie in D?

Dazu von oben genannter official source: Die Staatssekretäre und Staatssekretärinnen werden gemäß Artikel 70 Absatz 1 in Verbindung mit Artikel 78 Absatz 2 Bundes-Verfassungsgesetz vom Bundespräsidenten ernannt und zur Unterstützung in der Geschäftsführung und zur parlamentarischen Vertretung dem jeweiligen Bundesminister, der jeweiligen Bundesministerin beziehungsweise dem Bundeskanzler zugeordnet. Die Aufgaben- und Kompetenzbereiche werden von den Ressortleitenden festgelegt.

```{r}
url <- "https://en.wikipedia.org/wiki/Second_Kurz_government"

ministers_at <- read_html(url) %>% 
  html_node(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  filter(portrait == "") %>% 
  select(name, office, took_office, left_office, party)

ministers_at
```


# Belgium

Source with party affiliations: https://en.wikipedia.org/wiki/Federal_Government_of_Belgium
Official source: https://www.foderale-regierung.be/de

```{r}
url <- "https://en.wikipedia.org/wiki/Federal_Government_of_Belgium"

html <- read_html(url)
ministers_be <- html %>% 
  html_node(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  select(name = minister_2, everything(), -contains("na"), -minister) %>% 
  filter(!grepl("Minister", name)) %>% 
  mutate(name = str_remove(name,"[:blank:]\\[.*\\]"),
         cntry = "NL")

ministers_be %>% tbl_df()
```


# Bulgaria

Source with party affiliation: https://en.wikipedia.org/wiki/Government_of_Bulgaria
Official source: https://www.gov.bg/en/Cabinet/CABINET-MEMBERS

```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_Bulgaria"
html <- read_html(url)

ministers_bg <- html %>% 
  html_node(".toccolours") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  tbl_df() %>% 
  select(name = na, portfolio = ministry_2, party = na_2) %>% 
  mutate(cntry = "BG")

ministers_bg

```


# Croatia

Source: https://en.wikipedia.org/wiki/Government_of_Croatia
Official Source: https://vlada.gov.hr/clanovi-vlade/66


```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_Croatia"

ministers_hr <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  .[5] %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  filter(minister == "") %>% 
  select(minister = minister_1, portfolio, took_office, party)

ministers_hr
```


# Cyprus

Source: https://en.wikipedia.org/wiki/Second_Anastasiades_government
Official Source: https://presidency.gov.cy/en/council-of-ministers.html

Auch hier die Frage: Was ist mit den Deputy ministers und government spokesman. Vermutlich raus weil irrelevant oder zumindest "parteiäquivalent".

```{r}
url <- "https://en.wikipedia.org/wiki/Second_Anastasiades_government"

ministers_cy <- read_html(url) %>% 
  html_node(".wikitable") %>% 
  html_table() %>% 
  clean_names() %>% 
  filter(office != "") %>% 
  select(name, office, period, party = party_2) %>% 
  mutate(name = str_remove(name, "§"))

ministers_cy
```


# Czech Republic

Source: https://en.wikipedia.org/wiki/Government_of_the_Czech_Republic
Official Source: https://www.vlada.cz/en/vlada/

```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_the_Czech_Republic"

header_names <- read_html(url) %>% html_nodes(".toccolours") %>% html_table(fill = TRUE) %>% unlist() %>% .[c(1,32,63,94)] %>% unname() %>% as.character()

t <- read_html(url) %>% html_nodes(".toccolours") %>% html_table(fill = TRUE) %>% as.data.frame() %>% as_tibble()

names(t) <- header_names

ministers_cz <- t %>% 
  clean_names() %>% 
  filter(office != "", office != "Office") %>% 
  select(name, office, political_party)

ministers_cz
```



# Denmark

Source with party affiliation: https://www.thedanishparliament.dk/en/members/the-government
Official Source: https //www.thedanishparliament.dk/en/members/the-government


```{r}
url <- "https://www.thedanishparliament.dk/en/members/the-government"
html <- read_html(url)

name <- html %>% 
  html_nodes(".cellPic+ td") %>% 
  html_node("a") %>% 
  html_text()

ministers_dk <- html %>% 
  html_nodes(".cellPic+ td") %>% 
  html_text() %>% 
  tbl_df() %>% 
  separate(value, into = c("x","portfolio","party","y","z"), sep = "\r\n") %>% 
  mutate(name = name,
         portfolio = str_remove(portfolio, name),
         cntry = "DK") %>% 
  select(name, portfolio, party, cntry)

ministers_dk
  
```

# Estonia

Source with party affiliation: https://en.wikipedia.org/wiki/J%C3%BCri_Ratas%27_second_cabinet
Official source: https://www.hm.ee/en


```{r}
url <- "https://en.wikipedia.org/wiki/J%C3%BCri_Ratas%27_second_cabinet"
html <- read_html(url)

ministers_ee <- html %>% html_node(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  tbl_df() %>% 
  select(portfolio, name = minister_2, took_office, left_office, party) %>% 
  filter(!grepl(name, pattern = "Ministry"), !grepl(name, pattern = "Office")) %>% 
  mutate(name = str_remove(name,"\\[.*\\]"),
         cntry = "EE")

ministers_ee
```


# Finland

Source with party affiliation: https //valtioneuvosto.fi/en/marin/ministers
Official source: https://valtioneuvosto.fi/en/marin/ministers

```{r}
url <- "https://valtioneuvosto.fi/en/marin/ministers"
html <- read_html(url)

name <- html %>% html_nodes("#layout-column_column-5 .name") %>% html_text()
portfolio <- html %>% html_nodes(".title") %>% html_text()
links <- html %>% 
  html_nodes(".minister-tile") %>% 
  html_node("a") %>% 
  html_attr("href") %>% 
  paste0("https://valtioneuvosto.fi",.)

f_getparty <- function(link){
  p <- read_html(link) %>% html_node(".text p") %>% html_text()
  return(p)
}

ministers_fi <- bind_cols(portfolio = portfolio, name = name,  links = links) %>% 
  mutate(party = map_chr(links, f_getparty),
         cntry = "FI") %>% 
  select(-links)

ministers_fi
```


# France

Source with party affiliation: https://en.wikipedia.org/wiki/Second_Philippe_government
Official Source: https://www.gouvernement.fr/en/composition-of-the-government

```{r}
url <- "https://en.wikipedia.org/wiki/Second_Philippe_government"
html <- read_html(url)

ministers_fr <- html %>% 
  html_nodes(".wikitable") %>% 
  .[[4]] %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  tbl_df() %>% 
  filter(party == "") %>%
  mutate(cntry = "FR") %>% 
  select(portfolio = post, name = name, party = party_2)

ministers_fr

```



# Germany

Source: https://en.wikipedia.org/wiki/Cabinet_of_Germany
Official Source: https://www.bundesregierung.de/breg-de/bundesregierung/bundeskabinett

Gut hier: Direkte Zuordnung zum Ministerium der Staatsminister und Staatssekretäre

```{r}
url <- "https://en.wikipedia.org/wiki/Cabinet_of_Germany"

ministers_de <- read_html(url) %>% 
  html_node(".wikitable") %>% 
  html_table() %>% 
  clean_names() %>% 
  select(name = incumbent, 
         portfolio = office, 
         party, 
         in_office, 
         state_secs = parliamentary_state_secretaries_a_particular_field_of_responsibilities_where_applicable)

ministers_de
```


# Greece

Source: https://en.wikipedia.org/wiki/Cabinet_of_Kyriakos_Mitsotakis
Official: ??

Auch hier Deputy Ministers alle drin. Ist aber eh alles NeaDemocratia, aufgrund Wahlsystem bzw. Sitzverteilungsbonus für Gewinner.

Aber noch ohne Prime Minister und Deputy Prime Minister, evtl. aber für Ratskonstellationen auch nicht so dramatisch.

```{r}
url <- "https://en.wikipedia.org/wiki/Cabinet_of_Kyriakos_Mitsotakis"

ministers_gr <- read_html(url) %>% 
  html_nodes("table") %>% 
  .[3] %>% 
  html_table(fill = TRUE) %>%
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  select(name = incumbent, ministry, portfolio = office, party = party_1, in_office = in_office_since) %>% 
  mutate(ministry = str_remove(ministry, pattern = "^[:digit:][:digit:]*[.]"))

ministers_gr
```


# Hungary

Source: https://en.wikipedia.org/wiki/Fourth_Orb%C3%A1n_Government
Official Source: https://www.kormany.hu/en/members-of-the-government

```{r}
url <- "https://en.wikipedia.org/wiki/Fourth_Orb%C3%A1n_Government"

header_names <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  unlist() %>% 
  .[c(1,18,35,52,69,86)] %>% 
  unname()

t <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble()

names(t) <- header_names

ministers_hu <- t %>% 
  clean_names() %>% 
  filter(office != "Office") %>% 
  select(name = incumbent, portfolio = office, party = political_party_2, in_office)
```


# Ireland

Source: https://en.wikipedia.org/wiki/Government_of_Ireland
Official Source: https://www.finegael.ie/our-people/ministers/


```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_Ireland"

header_names <- read_html(url) %>% 
  html_nodes(".wikitable:nth-child(53)") %>% 
  html_table(fill = TRUE) %>% 
  unlist() %>% 
  .[names(.)=="Cabinet ministers1"] %>% 
  unname()

t <- read_html(url) %>% 
  html_nodes(".wikitable:nth-child(53)") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble()

names(t) <- header_names

ministers_ir <- t %>% 
  clean_names() %>% 
  select(name, portfolio = office_2, party = party_2, term) %>% 
  filter(name != "Name", name != "Also attending Cabinet")

ministers_ir
```


# Italy

Source: https://en.wikipedia.org/wiki/Council_of_Ministers_(Italy)
Official Source: ???

```{r}
url <- "https://en.wikipedia.org/wiki/Council_of_Ministers_(Italy)"

ministers_it <- read_html(url) %>% 
  html_nodes(".wikitable:nth-child(33)") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  filter(office != "") %>% 
  select(name, portfolio = office, party = party_1, term, deputies = deputy_ministers_undersecretaries)

ministers_it
```


# Latvia

Source: https://en.wikipedia.org/wiki/Government_of_Latvia
Official Source: https //www.mk.gov.lv/en/amatpersonas

```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_Latvia"

ministers_lv <- read_html(url) %>% html_node("p+ .wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  select(name, portfolio = position, party = party_2, in_office = dates)

ministers_lv
```


# Lithuania

Source: https://en.wikipedia.org/wiki/%C5%A0imonyt%C4%97_Cabinet
Official Source: https://lrv.lt/en/about-government/ministries-1

```{r}
url <- "https://en.wikipedia.org/wiki/%C5%A0imonyt%C4%97_Cabinet"

header_names <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  unlist() %>% 
  .[names(.) %in% c("Position1", "Name1", "Party1", "Office1")] %>% 
  unname()

t <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble()

names(t) <- header_names

ministers_lt <- t %>% 
  clean_names() %>% 
  filter(party != "Party") %>% 
  select(name, portfolio = position, party = party_2, took_office = office, left_office = start_date)

ministers_lt
```


# Luxembourg

Source: https://en.wikipedia.org/wiki/Bettel%E2%80%93Schneider_Ministry_II
Official Source: https://gouvernement.lu/de/gouvernement.html

```{r}
url <- "https://en.wikipedia.org/wiki/Bettel%E2%80%93Schneider_Ministry_II"

ministers_lu <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  select(name = name_1_1, portfolio = office, party)

ministers_lu
```


# Malta

Source: https://en.wikipedia.org/wiki/Maltese_Government_2017%E2%80%932022
Official Source: https://www.gov.mt/en/Government/Government%20of%20Malta/Ministries%20and%20Entities/Pages/default.aspx

```{r}
url <- "https://en.wikipedia.org/wiki/Maltese_Government_2017%E2%80%932022"

ministers_mt <- read_html(url) %>% 
  html_nodes(".wikitable~ .wikitable") %>% 
  html_table() %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  select(name = minister, portfolio, party = political_party, took_office = assumed_office, left_office)

ministers_mt
```


# Netherlands

Source: https://en.wikipedia.org/wiki/Cabinet_of_the_Netherlands
Official Source: https://www.rijksoverheid.nl/regering/bewindspersonen

```{r}
url <- "https://en.wikipedia.org/wiki/Cabinet_of_the_Netherlands"

ministers_nl <- read_html(url) %>% 
  html_nodes("h2+ .wikitable") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  filter(grepl(pattern = "Incumbent", term_of_office)) %>% 
  select(name = ministers_2, portfolio = title, party, term_of_office) %>% 
  group_by(name) %>% 
  mutate(party = case_when(party == portfolio ~ lag(party),
                           TRUE ~ party),
         name = str_remove(name, pattern = "\\(born 19[:digit:][:digit:]\\)$"))

ministers_nl
```


# Poland

Source: https://en.wikipedia.org/wiki/Second_Cabinet_of_Mateusz_Morawiecki
Official Source: https://www.premier.gov.pl/en.html

```{r}
url <- "https://en.wikipedia.org/wiki/Second_Cabinet_of_Mateusz_Morawiecki"

ministers_pl <- read_html(url) %>% 
  html_node(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  filter(image == "") %>% 
  select(name, portfolio = office, party = party_2, took_office = in_office, left_office = in_office_2)

ministers_pl
```


# Portugal

Source: https://en.wikipedia.org/wiki/Council_of_Ministers_(Portugal)
Official Source: https://www.portugal.gov.pt/en/gc21/government/composition

```{r}
url <- "https://en.wikipedia.org/wiki/Council_of_Ministers_(Portugal)"

t_ministers <- read_html(url) %>% 
  html_node(".wikitable+ .wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  select(name = incumbent_2, portfolio = ministry, in_office = term) %>% 
  rownames_to_column("id")

t_party <- read_html(url) %>% 
  html_nodes(".wikitable+ .wikitable td:nth-child(2)") %>% 
  html_attr("style") %>% 
  as_tibble_col("attr") %>% 
  mutate(party = case_when(str_detect(attr, pattern = "#FF66FF") ~ "Socialist Party",
                           str_detect(attr, pattern = "#DDDDDD") ~ "Independent")) %>% 
  rownames_to_column("id")

ministers_pt <- left_join(t_ministers, t_party, by = "id") %>% 
  select(name, portfolio, party, in_office)

ministers_pt
```


# Romania

Source: https://en.wikipedia.org/wiki/C%C3%AE%C8%9Bu_Cabinet
Official Source: https://gov.ro/en/government/the-cabinet-of-ministers

```{r}
url <- "https://en.wikipedia.org/wiki/C%C3%AE%C8%9Bu_Cabinet"

ministers_ro <- read_html(url, encoding = "UTF-8") %>% 
  html_node(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  clean_names() %>% 
  select(name = minister,
         portfolio = position, 
         party = party_2,
         took_office = date_sworn_in,
         left_office) %>% 
  mutate(portfolio = str_remove(portfolio, pattern = "\\(Romanian:.+\\)$"))

ministers_ro
```

# Slovakia

Source: https://en.wikipedia.org/wiki/Government_of_Slovakia
Offical Source: https://www.vlada.gov.sk/members-of-the-government/

```{r}
url <- "https://en.wikipedia.org/wiki/Government_of_Slovakia"

header_names <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  unlist() %>% 
  .[names(.) %in% c("11th Government of the Slovak Republic1")] %>% 
  unname()

t <- read_html(url) %>% 
  html_nodes(".wikitable") %>% 
  html_table(fill = TRUE) %>% 
  as.data.frame() %>% 
  as_tibble()

names(t) <- header_names

ministers_sk <- t %>% 
  clean_names() %>% 
  filter(position != name, party == "") %>% 
  select(name, portfolio = position, party = party_2, took_office, left_office)
```


# Slovenia

Source: https://en.wikipedia.org/wiki/14th_Government_of_Slovenia
Official Source: https://www.gov.si/en/state-authorities/government/about-the-government/

```{r}
url <- "https://en.wikipedia.org/wiki/14th_Government_of_Slovenia"

ministers_si <- read_html(url) %>% 
  html_nodes(".ambox-Refimprove~ p+ .wikitable") %>% 
  html_table() %>% 
  as.data.frame() %>% 
  as_tibble() %>% 
  clean_names() %>% 
  select(name, portfolio = position, party = party_1, took_office) %>% 
  mutate(name = str_remove(name, pattern = "\\(born 19[:digit:][:digit:]\\)$"))
```


# Spain
# Sweden 